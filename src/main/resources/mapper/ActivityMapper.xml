<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hsmy.mapper.ActivityMapper">

    <resultMap id="ActivityDomainResult" type="com.hsmy.domain.activity.ActivityDomain" autoMapping="true">
        <result column="rules" property="rules"
                typeHandler="com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler"/>
    </resultMap>

    <select id="selectActivityList" resultMap="ActivityDomainResult">
        SELECT
            id,
            activity_name,
            activity_type,
            `description`,
            banner_url,
            start_time,
            end_time,
            merit_bonus_rate,
            `rules`,
            status,
            sort_order,
            create_by,
            create_time,
            update_by,
            update_time,
            is_deleted
        FROM t_activity
        WHERE is_deleted = 0
        <if test="activityType != null and activityType != ''">
            AND activity_type = #{activityType}
        </if>
        <if test="status != null">
            AND status = #{status}
        </if>
        <if test="currentTime != null">
            AND start_time &lt;= #{currentTime}
            AND end_time &gt;= #{currentTime}
        </if>
        ORDER BY sort_order ASC, start_time DESC
    </select>
</mapper>

